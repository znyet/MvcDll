var url = "http://localhost:8123";

var data = { name: "你好", sex: 2, id: "-晕了-" };

var data2 = JSON.stringify(data);

//get传递多个
$.get(url + "/Home/GetByParam", data, function (ddd) {
	console.log(ddd);
})

//get传递实体
$.get(url + "/Home/GetByModel", data, function (ddd) {
	console.log(ddd);
})

//post实体
$.ajax({
	url: url + "/Home/PostModel",
	type: "post",
	data: data2,
	contentType: "application/json",
	success: function (data) {
		console.log(data);
	}
})

//post动态对象dynamic
$.ajax({
	url: url + "/Home/PostDynamic",
	type: "post",
	data: data2,
	contentType: "application/json",
	success: function (data) {
		console.log(data);
	}
})

//post一个也只能一个
$.post(url + "/Home/PostString", { "": "你好" }, function (data) {
	console.log(data);
})

//post一个也只能一个------>url带参数
$.post(url + "/Home/PostStringAndParam?id=这个id&name=这是2", { "": "你好" }, function (data) {
	console.log(data);
})

==============================================================================

namespace TestWebApi.Controllers
{
    public class HomeController : ApiController
    {
        [HttpGet]
        public HttpResponseMessage GetByParam(string id, int sex, string name)
        {
            var jsonStr = "{\"IsSuccess\":true,\"Data\":\"www.itdos.com\"}";
            var result = new HttpResponseMessage(HttpStatusCode.OK)
            {
                Content = new StringContent(jsonStr + id + sex + name, Encoding.UTF8, "text/plain")   //"text/json"
            };
            return result;
        }

        [HttpGet]
        public HttpResponseMessage GetByModel([FromUri]People p)
        {
            var jsonStr = "{\"IsSuccess\":true,\"Data\":\"www.itdos.com\"}";
            var result = new HttpResponseMessage(HttpStatusCode.OK)
            {
                Content = new StringContent(jsonStr + p.id + p.sex + p.name, Encoding.UTF8, "text/plain")
            };
            return result;
        }

        [HttpPost]
        public HttpResponseMessage PostModel([FromBody]People param)
        {
            var jsonStr = "{\"IsSuccess\":true,\"Data\":\"www.itdos.com\"}";
            var result = new HttpResponseMessage(HttpStatusCode.OK)
            {
                Content = new StringContent(jsonStr + param.id + param.sex + param.name, Encoding.UTF8, "text/plain")
            };
            return result;
        }

        [HttpPost]
        public HttpResponseMessage PostDynamic([FromBody]dynamic param)
        {
            var jsonStr = "{\"IsSuccess\":true,\"Data\":\"www.itdos.com\"}";
            var result = new HttpResponseMessage(HttpStatusCode.OK)
            {
                Content = new StringContent(jsonStr + param.id + param.sex + param.name, Encoding.UTF8, "text/plain")
            };
            return result;
        }



        [HttpPost]
        public HttpResponseMessage PostString([FromBody]string data)
        {
            var jsonStr = "{\"IsSuccess\":true,\"Data\":\"www.itdos.com\"}";
            var result = new HttpResponseMessage(HttpStatusCode.OK)
            {
                Content = new StringContent(jsonStr + data, Encoding.UTF8, "text/plain")
            };
            return result;
        }
		
		[HttpPost]
        public HttpResponseMessage PostStringAndParam([FromBody]string data, string id, string name)
        {
            var jsonStr = "{\"IsSuccess\":true,\"Data\":\"www.itdos.com\"}";
            var result = new HttpResponseMessage(HttpStatusCode.OK)
            {
                Content = new StringContent(jsonStr + data + id + name, Encoding.UTF8, "text/plain")
            };
            return result;
        }
		
    }


    public class People
    {
        public string id { get; set; }
        public string name { get; set; }
        public int sex { get; set; }


    }

}



=======================================================================

/// <summary>
/// 上传文件和参数
/// </summary>
/// <param name="query"></param>
/// <returns></returns>
[HttpPost]
public async Task<HttpResponseMessage> PostFile([FromUri]string query)
{

	//if (!Request.Content.IsMimeMultipartContent())
	//{
	//    throw new HttpResponseException(HttpStatusCode.UnsupportedMediaType);
	//}

	Console.WriteLine(query); //query参数

	var provider = new MultipartMemoryStreamProvider();
	await Request.Content.ReadAsMultipartAsync(provider);


	foreach (var item in provider.Contents)
	{
		var stream = item.ReadAsStreamAsync().Result;

		if (item.Headers.ContentDisposition.FileName == null) //post参数
		{
			Console.WriteLine(item.Headers.ContentDisposition.Name.Replace("\"","")); //post key
			StreamReader sr = new StreamReader(stream);
			Console.WriteLine(sr.ReadToEnd());
		}
		else //文件  
		{
			// 获取到流  

			if (stream.Length > 0)
			{
				byte[] bytes = new byte[stream.Length];
				stream.Read(bytes, 0, bytes.Length);
				var name = item.Headers.ContentDisposition.FileName.Replace("\"", "");
				string savePath = AppDomain.CurrentDomain.BaseDirectory + name;
				File.WriteAllBytes(savePath, bytes);        
			}

		}

	}

	var result = new HttpResponseMessage(HttpStatusCode.OK)
	{

		Content = new StringContent("", Encoding.UTF8, "text/html")
	};
	return result;
}

/// <summary>
/// 上传流数据
/// </summary>
/// <returns></returns>
[HttpPost]
public HttpResponseMessage PostStream()
{
	byte[] data = Request.Content.ReadAsByteArrayAsync().Result;

	var result = new HttpResponseMessage(HttpStatusCode.OK)
	{
		Content = new StringContent(Encoding.UTF8.GetString(data), Encoding.UTF8, "text/html")
	};
	return result;
}



-------------RestSharp---------------

var client = new RestClient("http://localhost:8123");
var req = new RestRequest("/Home/PostStream", Method.POST);
req.AddParameter("a", "你好", ParameterType.RequestBody);
var res = client.Execute(req);
Console.WriteLine(res.Content);
